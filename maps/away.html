<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <base href="../" />
    <link rel="stylesheet" href="dmdoc.css" />
    <title>maps&#x2F;away&#x2F;README.md - Space Station 13 - Nebula13</title>
</head>
<body>
<header>
    <a href="index.html">Space Station 13 - Nebula13</a> -
    <a href="index.html#modules">Modules</a> -
    <a href="index.html#types">Types</a>
</header>
<main>
<h1>Away sites <aside>maps/away/README.md</aside> 
            <a href="https://github.com/PersistentSS13/Nebula/blob/51f7abb65ac7d966c935ec0fe7abfc3b0e94f43c/maps/away/README.md">
        <img src="git.png" width="16" height="16" title="maps&#x2F;away&#x2F;README.md"/></a></h1>

<table class="summary" cellspacing="0">
        <tr><td colspan="2"><h2 id="what-exactly-is-an-away-site">What exactly is an away site?</h2>
<p>It's a kind of map template which:</p>
<ul>
<li>is placed in its own zlevel (or collection of zlevels),</li>
<li>should only get placed once per round,</li>
<li>can be randomly picked to be placed automatically during round setup,</li>
<li>normally has an overmap presence and shuttle landmarks so ships can fly to it.</li>
</ul>
<h3 id="er-whats-a-map-template">Er, what's a map template?</h3>
<p>It's a datum you can define in the code (<code>/datum/map_template</code>) which points at one or more .dmm map files, and allows the game (or admins) to spawn those map files when and where they please, whether that's into an existing zlevel (like decorating exoplanets with ruins), or on a totally fresh one (like an away site!).</p>
<h2 id="how-do-i-make-away-sites">How do I make away sites?</h2>
<p>tl;dr you make your .dmm files, then you write a new map template datum (<code>/datum/map_template/ruin/away_site/insert_your_away_site_name_here</code>), then you include whatever file you defined that datum in into the main map definition and <code>away_sites_testing.dm</code>, and you're all set.</p>
<p>BUT HEED MY RUMINATIONS</p>
<h2 id="while-mapping">While mapping</h2><h3 id="dont-use-map-specific-types">Don't use map-specific types</h3>
<p>Away maps are expected to work whether you're on a specific main map. That means your map mustn't use areas, turfs, objects, mobs or datums that are specific to any main map. You can use content packages to define content that is only included for particular maps, as the away sites are tested with all packages enabled.</p>
<p>e.g. you can use <code>/area/space</code>, or <code>/turf/simulated/wall</code>, because neither are specific to a given map. They live out in the main codebase, are always compiled in, and are available to all maps. But you can't use <code>/obj/random_multi/single_item/punitelly</code>, because Punitelli only exists when <code>punitelli.dm</code> is compiled.</p>
<p>To make life easier, you can uncheck your main map definition then recompile, to make sure these types aren't available while you're mapping.</p>
<h3 id="dont-re-use-area-types-from-other-maps">Don't re-use area types from other maps</h3>
<p>Except for, like, <code>/area/space</code>. That one's probably fine.</p>
<p>(Now that's just areas! Other stuff might be ok. Except very map-specific stuff as noted!)</p>
<p>Re-using areas is a shortcut, but it's bad for testability, and you can't guarantee that the area you re-use isn't loaded up and in active use on the server - in which case it'll hideously merge together with its brother in terms of stuff like air alarms, APCs, etc. Suddenly your derelict starship is randomly receiving power from another zlevel. Not good. Avoid. Make your own area types!</p>
<p>If in doubt, ask #codershuttle on IRC/#coding on Discord.</p>
<h3 id="if-youre-doing-multi-z-make-a-different-dmm-file-for-each-zlevel">If you're doing multi-z, make a different .dmm file for each zlevel</h3>
<p>Not exactly a technical requirement, but it makes things easier in terms of collaboration. See how it's done with <code>example-1.dmm</code>, <code>example-2.dmm</code>, etc.</p>
<h2 id="afterwards-or-during-im-not-a-cop">Afterwards (or during, I'm not a cop)</h2><h3 id="make-sure-youve-got-a-dm-file-for-all-your-stuff">Make sure you've got a .dm file for all your stuff</h3>
<p>Like <code>maps/away/derelict/derelict.dm</code>. It's a pretty good place to put all your new types! #include other files here too. This file's going to be the hub of your map's wheel, to cack-hand a metaphor.</p>
<h3 id="make-a-map-template-datum-there">Make a map template datum there</h3>
<p>The game will read this to learn about your new shiny away sites, including what .dmm files it needs to load, how much it 'costs' to spawn (usually 1, increase for more performance-heavy away sites). Ask devs or read code if unsure.</p>
<h3 id="include-your-dm-file-in-any-main-map-file-and-away-sites-testing">Include your .dm file in any main map file, and away sites testing</h3>
<p>That's <code>maps/away_sites_testing/away_sites_testing.dm</code> plus your main map definition. It goes in the testing one to make sure it is checked by unit testing, and it goes in the primary map to make it available during real play.</p>
<h3 id="dont-include-it-or-the-dmms-in-the-dme">Don't include it, or the .dmms, in the .dme</h3>
<p>That means don't have any of your away map stuff checked in Dream Maker. It'll get included, as if by magic, via the work you did in the previous step!</p>
<p>That's it! You're probably done! Unless the unit tests explode on you.</p>
<h3 id="some-of-the-stuff-i-put-in-my-map-isnt-behaving-properly">Some of the stuff I put in my map isn't behaving properly!</h3>
<p>The map loader works best when everything it's spawning does all its initialisation work in <code>Initialize</code>, instead of in <code>New</code>. Most likely your misbehaving thing is doing more initialisation than is healthy in <code>New</code>. It's fixable! Often not even that hard. Go talk to a dev.</p></td></tr></table></main>
<footer>
    nebula.dme
    <a href="https://github.com/PersistentSS13/Nebula/tree/51f7abb65ac7d966c935ec0fe7abfc3b0e94f43c">51f7abb</a>
        (dev) &mdash; <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/src/dmdoc/README.md">dmdoc 1.4.1</a></footer>
</body>
</html>
